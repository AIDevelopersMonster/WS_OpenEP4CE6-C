/*-----版权声明-----
 *     艾米电子工作室――让开发变得更简单 
 *     网站：http://www.amy-studio.com
 *     淘宝：http://amy-studio.taobao.com
 *     QQ（邮箱）：amy-studio@qq.com
 *-----文件信息-----
 *     文件名称：ds18b20_seg7.v
 *     最后修改日期：3.12, 2010
 *     描述：DS18B20采集温度，七段数码管显示
 *------------------
 *     创建者：张亚峰
 *     创建日期：3.12, 2010
 *     版本：1.0
 *     描述：原始版本
 *------------------
 *     修改者：
 *     修改日期：
 *     版本：
 *     描述：
 *-------------------
 */
 
module ds18b20_seg7(
  input        CLOCK_50,                // 板载50MHz时钟 
  input        Q_KEY,                   // 板载按键RST
  //
  inout        DS18B20,
  //
  output [7:0] SEG7_SEG,                // 七段数码管 段脚              
  output [2:0] SEG7_SEL                 // 七段数码管 待译位脚 
);

//++++++++++++++++++++++++++++++++++++++
// 获取温度值 开始
//++++++++++++++++++++++++++++++++++++++
wire [15:0] t_buf;

ds18b20_drive ds18b20_u0(
  .clk(CLOCK_50),
  .rst_n(Q_KEY),
  //
  .one_wire(DS18B20),
  //
  .temperature(t_buf)
);
//-------------------------------------
// 获取温度值 结束
//-------------------------------------

//+++++++++++++++++++++++++++++++++++++
// 显示键盘值 开始
//+++++++++++++++++++++++++++++++++++++
seg7x8_drive seg7_u0(
  .i_clk            (CLOCK_50),
  .i_rst_n          (Q_KEY),
  
  .i_turn_off       (8'b1110_1000),             // 熄灭位[2进制]
  .i_dp             (8'b0000_0010),             // 小数点位[2进制]
  // 欲显数据[16进制]
  // 正负位 空白 十位 个位 小数位
  .i_data           ({12'h0, t_buf[15:12], 4'h0, t_buf[11:0]}),
  
  .o_seg            (SEG7_SEG),
  .o_sel            (SEG7_SEL)
);
//-------------------------------------
// 显示键盘值 结束
//-------------------------------------

endmodule
